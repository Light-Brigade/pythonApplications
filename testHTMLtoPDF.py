{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "7663633a-3046-432d-9cd1-7abd063f5e53",
   "metadata": {},
   "outputs": [],
   "source": [
    "# from weasyprint import HTML\n",
    "# import os\n",
    "# import time\n",
    "\n",
    "# def convert_to_pdf(input_file, output_pdf_file):\n",
    "#     try:\n",
    "#         start_time = time.time()  # Record the start time\n",
    "\n",
    "#         # Determine file type based on extension\n",
    "#         file_extension = os.path.splitext(input_file)[1].lower()\n",
    "\n",
    "#         # Check if the output PDF file already exists\n",
    "#         if os.path.exists(output_pdf_file):\n",
    "#             raise FileExistsError(f\"A PDF file with the name '{output_pdf_file}' already exists.\")\n",
    "\n",
    "#         if file_extension == '.htm':\n",
    "#             # HTML file, use WeasyPrint\n",
    "#             html = HTML(filename=input_file)\n",
    "#             html.write_pdf(output_pdf_file)\n",
    "#         elif file_extension == '.txt':\n",
    "#             # Text file, basic conversion\n",
    "#             with open(input_file, 'r', encoding='utf-8') as txt_file:\n",
    "#                 text_content = txt_file.read()\n",
    "#                 HTML(string=text_content).write_pdf(output_pdf_file)\n",
    "#         elif file_extension == '.docx':\n",
    "#             # Word document, additional processing required\n",
    "#             # Implement Word to PDF conversion logic here\n",
    "#             pass\n",
    "#         else:\n",
    "#             print(f\"Error: Unsupported file type '{file_extension}'. Unable to convert to PDF.\")\n",
    "#             return\n",
    "\n",
    "#         # Check if the PDF file was generated\n",
    "#         if os.path.exists(output_pdf_file):\n",
    "#             print(f\"Conversion successful. PDF saved to {output_pdf_file}\")\n",
    "#         else:\n",
    "#             print(\"Error: PDF generation failed.\")\n",
    "\n",
    "#         end_time = time.time()  # Record the end time\n",
    "#         elapsed_time = end_time - start_time\n",
    "#         print(f\"Time taken: {elapsed_time} seconds\")\n",
    "\n",
    "#     except FileNotFoundError:\n",
    "#         print(f\"Error: Input file '{input_file}' not found.\")\n",
    "#     except FileExistsError as e:\n",
    "#         print(f\"Error: {e}\")\n",
    "#     except Exception as e:\n",
    "#         print(f\"Error: {e}\")\n",
    "\n",
    "# # Example usage:\n",
    "# input_file_path = r'C:\\Users\\zakir\\Desktop\\Work\\Contractor portal Assignment Schedule_Batt.htm'\n",
    "# output_pdf_path = r'C:\\Users\\zakir\\Desktop\\Work\\outputTestV10.pdf'\n",
    "\n",
    "# convert_to_pdf(input_file_path, output_pdf_path)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "47de5227-9f7d-45d2-855d-7ded809845f0",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "-----\n",
      "\n",
      "WeasyPrint could not import some external libraries. Please carefully follow the installation steps before reporting an issue:\n",
      "https://doc.courtbouillon.org/weasyprint/stable/first_steps.html#installation\n",
      "https://doc.courtbouillon.org/weasyprint/stable/first_steps.html#troubleshooting \n",
      "\n",
      "-----\n",
      "\n"
     ]
    },
    {
     "ename": "OSError",
     "evalue": "cannot load library 'pango-1.0-0': error 0x7e.  Additionally, ctypes.util.find_library() did not manage to locate a library called 'pango-1.0-0'",
     "output_type": "error",
     "traceback": [
      "\u001b[1;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[1;31mOSError\u001b[0m                                   Traceback (most recent call last)",
      "Cell \u001b[1;32mIn[3], line 4\u001b[0m\n\u001b[0;32m      2\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01mtkinter\u001b[39;00m \u001b[38;5;28;01mimport\u001b[39;00m filedialog\n\u001b[0;32m      3\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01mtkinter\u001b[39;00m \u001b[38;5;28;01mimport\u001b[39;00m messagebox\n\u001b[1;32m----> 4\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01mweasyprint\u001b[39;00m \u001b[38;5;28;01mimport\u001b[39;00m HTML\n\u001b[0;32m      5\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01mdocx\u001b[39;00m \u001b[38;5;28;01mimport\u001b[39;00m Document\n\u001b[0;32m      6\u001b[0m \u001b[38;5;28;01mimport\u001b[39;00m \u001b[38;5;21;01mos\u001b[39;00m\n",
      "File \u001b[1;32m~\\Desktop\\Work\\Virtual Environments\\dataManipulation\\Lib\\site-packages\\weasyprint\\__init__.py:387\u001b[0m\n\u001b[0;32m    384\u001b[0m         \u001b[38;5;28;01myield\u001b[39;00m \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mstring\u001b[39m\u001b[38;5;124m'\u001b[39m, string, base_url, \u001b[38;5;28;01mNone\u001b[39;00m\n\u001b[0;32m    386\u001b[0m \u001b[38;5;66;03m# Work around circular imports.\u001b[39;00m\n\u001b[1;32m--> 387\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01mcss\u001b[39;00m \u001b[38;5;28;01mimport\u001b[39;00m preprocess_stylesheet  \u001b[38;5;66;03m# noqa isort:skip\u001b[39;00m\n\u001b[0;32m    388\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01mhtml\u001b[39;00m \u001b[38;5;28;01mimport\u001b[39;00m (  \u001b[38;5;66;03m# noqa isort:skip\u001b[39;00m\n\u001b[0;32m    389\u001b[0m     HTML5_UA_COUNTER_STYLE, HTML5_UA_STYLESHEET, HTML5_UA_FORM_STYLESHEET,\n\u001b[0;32m    390\u001b[0m     HTML5_PH_STYLESHEET)\n\u001b[0;32m    391\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01mdocument\u001b[39;00m \u001b[38;5;28;01mimport\u001b[39;00m Document, Page  \u001b[38;5;66;03m# noqa isort:skip\u001b[39;00m\n",
      "File \u001b[1;32m~\\Desktop\\Work\\Virtual Environments\\dataManipulation\\Lib\\site-packages\\weasyprint\\css\\__init__.py:25\u001b[0m\n\u001b[0;32m     23\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01mlogger\u001b[39;00m \u001b[38;5;28;01mimport\u001b[39;00m LOGGER, PROGRESS_LOGGER\n\u001b[0;32m     24\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01murls\u001b[39;00m \u001b[38;5;28;01mimport\u001b[39;00m URLFetchingError, get_url_attribute, url_join\n\u001b[1;32m---> 25\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01m.\u001b[39;00m \u001b[38;5;28;01mimport\u001b[39;00m computed_values, counters, media_queries\n\u001b[0;32m     26\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01mproperties\u001b[39;00m \u001b[38;5;28;01mimport\u001b[39;00m INHERITED, INITIAL_NOT_COMPUTED, INITIAL_VALUES\n\u001b[0;32m     27\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01mutils\u001b[39;00m \u001b[38;5;28;01mimport\u001b[39;00m get_url, remove_whitespace\n",
      "File \u001b[1;32m~\\Desktop\\Work\\Virtual Environments\\dataManipulation\\Lib\\site-packages\\weasyprint\\css\\computed_values.py:11\u001b[0m\n\u001b[0;32m      8\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01mtinycss2\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01mcolor3\u001b[39;00m \u001b[38;5;28;01mimport\u001b[39;00m parse_color\n\u001b[0;32m     10\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01mlogger\u001b[39;00m \u001b[38;5;28;01mimport\u001b[39;00m LOGGER\n\u001b[1;32m---> 11\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01mtext\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01mffi\u001b[39;00m \u001b[38;5;28;01mimport\u001b[39;00m ffi, pango, units_to_double\n\u001b[0;32m     12\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01mtext\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01mline_break\u001b[39;00m \u001b[38;5;28;01mimport\u001b[39;00m Layout, first_line_metrics\n\u001b[0;32m     13\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01murls\u001b[39;00m \u001b[38;5;28;01mimport\u001b[39;00m get_link_attribute\n",
      "File \u001b[1;32m~\\Desktop\\Work\\Virtual Environments\\dataManipulation\\Lib\\site-packages\\weasyprint\\text\\ffi.py:431\u001b[0m\n\u001b[0;32m    426\u001b[0m             os\u001b[38;5;241m.\u001b[39madd_dll_directory(dll_directory)\n\u001b[0;32m    428\u001b[0m gobject \u001b[38;5;241m=\u001b[39m _dlopen(\n\u001b[0;32m    429\u001b[0m     ffi, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mgobject-2.0-0\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mgobject-2.0\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mlibgobject-2.0-0\u001b[39m\u001b[38;5;124m'\u001b[39m,\n\u001b[0;32m    430\u001b[0m     \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mlibgobject-2.0.so.0\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mlibgobject-2.0.dylib\u001b[39m\u001b[38;5;124m'\u001b[39m,  \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mlibgobject-2.0-0.dll\u001b[39m\u001b[38;5;124m'\u001b[39m)\n\u001b[1;32m--> 431\u001b[0m pango \u001b[38;5;241m=\u001b[39m \u001b[43m_dlopen\u001b[49m\u001b[43m(\u001b[49m\n\u001b[0;32m    432\u001b[0m \u001b[43m    \u001b[49m\u001b[43mffi\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[38;5;124;43mpango-1.0-0\u001b[39;49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[38;5;124;43mpango-1.0\u001b[39;49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[38;5;124;43mlibpango-1.0-0\u001b[39;49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[38;5;124;43mlibpango-1.0.so.0\u001b[39;49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[43m,\u001b[49m\n\u001b[0;32m    433\u001b[0m \u001b[43m    \u001b[49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[38;5;124;43mlibpango-1.0.dylib\u001b[39;49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[38;5;124;43mlibpango-1.0-0.dll\u001b[39;49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[43m)\u001b[49m\n\u001b[0;32m    434\u001b[0m harfbuzz \u001b[38;5;241m=\u001b[39m _dlopen(\n\u001b[0;32m    435\u001b[0m     ffi, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mharfbuzz\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mharfbuzz-0.0\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mlibharfbuzz-0\u001b[39m\u001b[38;5;124m'\u001b[39m,\n\u001b[0;32m    436\u001b[0m     \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mlibharfbuzz.so.0\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mlibharfbuzz.so.0\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mlibharfbuzz.0.dylib\u001b[39m\u001b[38;5;124m'\u001b[39m,\n\u001b[0;32m    437\u001b[0m     \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mlibharfbuzz-0.dll\u001b[39m\u001b[38;5;124m'\u001b[39m)\n\u001b[0;32m    438\u001b[0m fontconfig \u001b[38;5;241m=\u001b[39m _dlopen(\n\u001b[0;32m    439\u001b[0m     ffi, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mfontconfig-1\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mfontconfig\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mlibfontconfig\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mlibfontconfig.so.1\u001b[39m\u001b[38;5;124m'\u001b[39m,\n\u001b[0;32m    440\u001b[0m     \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mlibfontconfig.1.dylib\u001b[39m\u001b[38;5;124m'\u001b[39m, \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mlibfontconfig-1.dll\u001b[39m\u001b[38;5;124m'\u001b[39m)\n",
      "File \u001b[1;32m~\\Desktop\\Work\\Virtual Environments\\dataManipulation\\Lib\\site-packages\\weasyprint\\text\\ffi.py:417\u001b[0m, in \u001b[0;36m_dlopen\u001b[1;34m(ffi, *names)\u001b[0m\n\u001b[0;32m    407\u001b[0m \u001b[38;5;66;03m# Re-raise the exception.\u001b[39;00m\n\u001b[0;32m    408\u001b[0m \u001b[38;5;28mprint\u001b[39m(\n\u001b[0;32m    409\u001b[0m     \u001b[38;5;124m'\u001b[39m\u001b[38;5;130;01m\\n\u001b[39;00m\u001b[38;5;124m-----\u001b[39m\u001b[38;5;130;01m\\n\u001b[39;00m\u001b[38;5;130;01m\\n\u001b[39;00m\u001b[38;5;124m'\u001b[39m\n\u001b[0;32m    410\u001b[0m     \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mWeasyPrint could not import some external libraries. Please \u001b[39m\u001b[38;5;124m'\u001b[39m\n\u001b[1;32m   (...)\u001b[0m\n\u001b[0;32m    415\u001b[0m     \u001b[38;5;124m'\u001b[39m\u001b[38;5;124mfirst_steps.html#troubleshooting\u001b[39m\u001b[38;5;124m'\u001b[39m,\n\u001b[0;32m    416\u001b[0m     \u001b[38;5;124m'\u001b[39m\u001b[38;5;130;01m\\n\u001b[39;00m\u001b[38;5;130;01m\\n\u001b[39;00m\u001b[38;5;124m-----\u001b[39m\u001b[38;5;130;01m\\n\u001b[39;00m\u001b[38;5;124m'\u001b[39m)  \u001b[38;5;66;03m# pragma: no cover\u001b[39;00m\n\u001b[1;32m--> 417\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43mffi\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mdlopen\u001b[49m\u001b[43m(\u001b[49m\u001b[43mnames\u001b[49m\u001b[43m[\u001b[49m\u001b[38;5;241;43m0\u001b[39;49m\u001b[43m]\u001b[49m\u001b[43m)\u001b[49m\n",
      "File \u001b[1;32m~\\Desktop\\Work\\Virtual Environments\\dataManipulation\\Lib\\site-packages\\cffi\\api.py:150\u001b[0m, in \u001b[0;36mFFI.dlopen\u001b[1;34m(self, name, flags)\u001b[0m\n\u001b[0;32m    147\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mTypeError\u001b[39;00m(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mdlopen(name): name must be a file name, None, \u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m    148\u001b[0m                     \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mor an already-opened \u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mvoid *\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124m handle\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\u001b[0;32m    149\u001b[0m \u001b[38;5;28;01mwith\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_lock:\n\u001b[1;32m--> 150\u001b[0m     lib, function_cache \u001b[38;5;241m=\u001b[39m \u001b[43m_make_ffi_library\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mname\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mflags\u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m    151\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_function_caches\u001b[38;5;241m.\u001b[39mappend(function_cache)\n\u001b[0;32m    152\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_libraries\u001b[38;5;241m.\u001b[39mappend(lib)\n",
      "File \u001b[1;32m~\\Desktop\\Work\\Virtual Environments\\dataManipulation\\Lib\\site-packages\\cffi\\api.py:832\u001b[0m, in \u001b[0;36m_make_ffi_library\u001b[1;34m(ffi, libname, flags)\u001b[0m\n\u001b[0;32m    830\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21m_make_ffi_library\u001b[39m(ffi, libname, flags):\n\u001b[0;32m    831\u001b[0m     backend \u001b[38;5;241m=\u001b[39m ffi\u001b[38;5;241m.\u001b[39m_backend\n\u001b[1;32m--> 832\u001b[0m     backendlib \u001b[38;5;241m=\u001b[39m \u001b[43m_load_backend_lib\u001b[49m\u001b[43m(\u001b[49m\u001b[43mbackend\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mlibname\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mflags\u001b[49m\u001b[43m)\u001b[49m\n\u001b[0;32m    833\u001b[0m     \u001b[38;5;66;03m#\u001b[39;00m\n\u001b[0;32m    834\u001b[0m     \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21maccessor_function\u001b[39m(name):\n",
      "File \u001b[1;32m~\\Desktop\\Work\\Virtual Environments\\dataManipulation\\Lib\\site-packages\\cffi\\api.py:827\u001b[0m, in \u001b[0;36m_load_backend_lib\u001b[1;34m(backend, name, flags)\u001b[0m\n\u001b[0;32m    825\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m first_error \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[0;32m    826\u001b[0m         msg \u001b[38;5;241m=\u001b[39m \u001b[38;5;124m\"\u001b[39m\u001b[38;5;132;01m%s\u001b[39;00m\u001b[38;5;124m.  Additionally, \u001b[39m\u001b[38;5;132;01m%s\u001b[39;00m\u001b[38;5;124m\"\u001b[39m \u001b[38;5;241m%\u001b[39m (first_error, msg)\n\u001b[1;32m--> 827\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mOSError\u001b[39;00m(msg)\n\u001b[0;32m    828\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m backend\u001b[38;5;241m.\u001b[39mload_library(path, flags)\n",
      "\u001b[1;31mOSError\u001b[0m: cannot load library 'pango-1.0-0': error 0x7e.  Additionally, ctypes.util.find_library() did not manage to locate a library called 'pango-1.0-0'"
     ]
    }
   ],
   "source": [
    "import tkinter as tk\n",
    "from tkinter import filedialog\n",
    "from tkinter import messagebox\n",
    "from weasyprint import HTML\n",
    "from docx import Document\n",
    "import os\n",
    "import time\n",
    "from threading import Thread\n",
    "\n",
    "class PDFConverterApp:\n",
    "    def __init__(self, master):\n",
    "        self.master = master\n",
    "        master.title(\"PDF Converter\")\n",
    "\n",
    "        self.label_input = tk.Label(master, text=\"Input File:\")\n",
    "        self.label_input.pack()\n",
    "\n",
    "        self.entry_input = tk.Entry(master, width=50)\n",
    "        self.entry_input.pack()\n",
    "\n",
    "        self.button_browse_input = tk.Button(master, text=\"Browse\", command=self.browse_input)\n",
    "        self.button_browse_input.pack()\n",
    "\n",
    "        self.label_output = tk.Label(master, text=\"Output File:\")\n",
    "        self.label_output.pack()\n",
    "\n",
    "        self.entry_output = tk.Entry(master, width=50)\n",
    "        self.entry_output.pack()\n",
    "\n",
    "        self.button_browse_output = tk.Button(master, text=\"Browse\", command=self.browse_output)\n",
    "        self.button_browse_output.pack()\n",
    "\n",
    "        self.button_convert = tk.Button(master, text=\"Convert\", command=self.convert)\n",
    "        self.button_convert.pack()\n",
    "\n",
    "        self.progress_label = tk.Label(master, text=\"\")\n",
    "\n",
    "    def browse_input(self):\n",
    "        file_path = filedialog.askopenfilename(filetypes=[(\"Supported Files\", \"*.htm;*.txt;*.docx\")])\n",
    "        self.entry_input.delete(0, tk.END)\n",
    "        self.entry_input.insert(0, file_path)\n",
    "\n",
    "    def browse_output(self):\n",
    "        file_path = filedialog.asksaveasfilename(defaultextension=\".pdf\", filetypes=[(\"PDF files\", \"*.pdf\")])\n",
    "        self.entry_output.delete(0, tk.END)\n",
    "        self.entry_output.insert(0, file_path)\n",
    "\n",
    "    def convert(self):\n",
    "        input_file = self.entry_input.get()\n",
    "        output_file = self.entry_output.get()\n",
    "\n",
    "        if not input_file or not output_file:\n",
    "            messagebox.showwarning(\"Error\", \"Please select input and output files.\")\n",
    "            return\n",
    "\n",
    "        # Disable the Convert button during conversion\n",
    "        self.button_convert.config(state=tk.DISABLED)\n",
    "        \n",
    "        # Update the label to indicate conversion is in progress\n",
    "        self.progress_label.config(text=\"Converting File to PDF...\")\n",
    "        self.progress_label.pack()\n",
    "\n",
    "        # Start a separate thread to perform the conversion\n",
    "        conversion_thread = Thread(target=self.perform_conversion, args=(input_file, output_file))\n",
    "        conversion_thread.start()\n",
    "\n",
    "    def perform_conversion(self, input_file, output_file):\n",
    "        try:\n",
    "            convert_to_pdf(input_file, output_file)\n",
    "            # Notify the main thread that the conversion is complete\n",
    "            self.master.after(0, self.on_conversion_complete)\n",
    "        except Exception as e:\n",
    "            # Notify the main thread of the error\n",
    "            self.master.after(0, lambda: self.on_conversion_error(e))\n",
    "\n",
    "    def on_conversion_complete(self):\n",
    "        self.progress_label.config(text=\"Conversion successful. PDF saved.\")\n",
    "        # Enable the Convert button\n",
    "        self.button_convert.config(state=tk.NORMAL)\n",
    "\n",
    "        # Display pop-up message\n",
    "        messagebox.showinfo(\"Conversion Complete\", \"Conversion successful. PDF saved.\")\n",
    "\n",
    "    def on_conversion_error(self, error):\n",
    "        self.progress_label.config(text=f\"Error: {error}\")\n",
    "        # Enable the Convert button\n",
    "        self.button_convert.config(state=tk.NORMAL)\n",
    "\n",
    "        # Display pop-up message\n",
    "        messagebox.showerror(\"Conversion Error\", f\"Error: {error}\")\n",
    "\n",
    "if __name__ == \"__main__\":\n",
    "    root = tk.Tk()\n",
    "    app = PDFConverterApp(root)\n",
    "    root.mainloop()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "833fc869-6bba-477d-8de8-b814c5ed1680",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "dataManipulation",
   "language": "python",
   "name": "datamanipulation"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
